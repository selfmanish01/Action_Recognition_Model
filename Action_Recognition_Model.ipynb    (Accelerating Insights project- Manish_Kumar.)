{"cells":[{"cell_type":"markdown","metadata":{"id":"KTZtvw34s658"},"source":["# Step 1: Import all necessary modules/libraries that needed for this project.\n"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"VTZz0ppMtIvO","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1705421171065,"user_tz":-330,"elapsed":20865,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"}},"outputId":"c013ea80-5457-42b8-db7a-bc2d66d1a368"},"outputs":[{"output_type":"stream","name":"stdout","text":["  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n"]}],"source":["!pip install -q imageio\n","!pip install -q opencv-python\n","!pip install -q git+https://github.com/tensorflow/docs"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"USf0UvkYIlKo","executionInfo":{"status":"ok","timestamp":1705421186664,"user_tz":-330,"elapsed":4743,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"}}},"outputs":[],"source":["\n","# TensorFlow and TF-Hub modules.\n","from absl import logging\n","\n","import tensorflow as tf\n","import tensorflow_hub as hub\n","from tensorflow_docs.vis import embed\n","\n","logging.set_verbosity(logging.ERROR)\n","\n","# Some modules to help with reading the UCF101 dataset.\n","import random\n","import re\n","import os\n","import tempfile\n","import ssl\n","import cv2\n","import numpy as np\n","\n","# Some modules to display an animation using imageio.\n","import imageio\n","from IPython import display\n","\n","from urllib import request  # requires python3"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"3d_nTXdktCgK","executionInfo":{"status":"ok","timestamp":1705421194450,"user_tz":-330,"elapsed":1191,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"}}},"outputs":[],"source":[]},{"cell_type":"markdown","metadata":{"id":"f5ju43bztD-N"},"source":["# Step 2: Helper functions for the UCF101 dataset for slicing the data."]},{"cell_type":"code","execution_count":6,"metadata":{"id":"31NMs-GttdtQ","executionInfo":{"status":"ok","timestamp":1705421203012,"user_tz":-330,"elapsed":10,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"}}},"outputs":[],"source":["# Utilities to fetch videos from UCF101 dataset\n","UCF_ROOT = \"https://www.crcv.ucf.edu/THUMOS14/UCF101/UCF101/\"\n","_VIDEO_LIST = None\n","_CACHE_DIR = tempfile.mkdtemp()\n","unverified_context = ssl._create_unverified_context()\n","\n","def list_ucf_videos():\n","  global _VIDEO_LIST\n","  if not _VIDEO_LIST:\n","    index = request.urlopen(UCF_ROOT, context=unverified_context).read().decode(\"utf-8\")\n","    videos = re.findall(\"(v_[\\w_]+\\.avi)\", index)\n","    _VIDEO_LIST = sorted(set(videos))\n","  return list(_VIDEO_LIST)\n","\n","def fetch_ucf_video(video):\n","  cache_path = os.path.join(_CACHE_DIR, video)\n","  if not os.path.exists(cache_path):\n","    urlpath = request.urljoin(UCF_ROOT, video)\n","    print(\"Fetching %s => %s\" % (urlpath, cache_path))\n","    data = request.urlopen(urlpath, context=unverified_context).read()\n","    open(cache_path, \"wb\").write(data)\n","  return cache_path\n","\n","def crop_center_square(frame):\n","  y, x = frame.shape[0:2]\n","  min_dim = min(y, x)\n","  start_x = (x // 2) - (min_dim // 2)\n","  start_y = (y // 2) - (min_dim // 2)\n","  return frame[start_y:start_y+min_dim,start_x:start_x+min_dim]\n","\n","def load_video(path, max_frames=0, resize=(224, 224)):\n","  cap = cv2.VideoCapture(path)\n","  frames = []\n","  try:\n","    while True:\n","      ret, frame = cap.read()\n","      if not ret:\n","        break\n","      frame = crop_center_square(frame)\n","      frame = cv2.resize(frame, resize)\n","      frame = frame[:, :, [2, 1, 0]]\n","      frames.append(frame)\n","\n","      if len(frames) == max_frames:\n","        break\n","  finally:\n","    cap.release()\n","  return np.array(frames) / 255.0\n","\n","def to_gif(images):\n","  converted_images = np.clip(images * 255, 0, 255).astype(np.uint8)\n","  imageio.mimsave('./animation.gif', converted_images, fps=25)\n","  return embed.embed_file('./animation.gif')"]},{"cell_type":"markdown","metadata":{"id":"F4CqIAvgtuG9"},"source":["# Step 3:  Get the kinetics-400 labels of human action"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1044,"status":"ok","timestamp":1705421214688,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"},"user_tz":-330},"id":"D5K-M1b8tn6S","outputId":"e79b0c49-7bbc-42a2-a18f-3c9761ee8751"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found in total 400 labels.\n"]}],"source":["KINETICS_URL = \"https://raw.githubusercontent.com/deepmind/kinetics-i3d/master/data/label_map.txt\"\n","with request.urlopen(KINETICS_URL) as obj:\n","  labels = [line.decode(\"utf-8\").strip() for line in obj.readlines()]\n","print(\"Found in total %d labels.\" % len(labels))"]},{"cell_type":"markdown","metadata":{"id":"4J1dNlo9t7Yo"},"source":["# Step 4: Get UCF101 Dataset"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1518,"status":"ok","timestamp":1705421222159,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"},"user_tz":-330},"id":"dOVcJTivt0fY","outputId":"062d7bd7-c684-4f4d-9887-0b99a78f9f11"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found in total 13320 videos in overall 101 categories.\n","\n","\n","  CATEGORY  \t   No. of Videos  \t\t\t  Details\n","ApplyEyeMakeup           145           v_ApplyEyeMakeup_g01_c01.avi, v_ApplyEyeMakeup_g01_c02.avi, ...\n","ApplyLipstick            114           v_ApplyLipstick_g01_c01.avi, v_ApplyLipstick_g01_c02.avi, ...\n","Archery                  145           v_Archery_g01_c01.avi, v_Archery_g01_c02.avi, ...\n","BabyCrawling             132           v_BabyCrawling_g01_c01.avi, v_BabyCrawling_g01_c02.avi, ...\n","BalanceBeam              108           v_BalanceBeam_g01_c01.avi, v_BalanceBeam_g01_c02.avi, ...\n","BandMarching             155           v_BandMarching_g01_c01.avi, v_BandMarching_g01_c02.avi, ...\n","BaseballPitch            150           v_BaseballPitch_g01_c01.avi, v_BaseballPitch_g01_c02.avi, ...\n","BasketballDunk           131           v_BasketballDunk_g01_c01.avi, v_BasketballDunk_g01_c02.avi, ...\n","Basketball               134           v_Basketball_g01_c01.avi, v_Basketball_g01_c02.avi, ...\n","BenchPress               160           v_BenchPress_g01_c01.avi, v_BenchPress_g01_c02.avi, ...\n","Biking                   134           v_Biking_g01_c01.avi, v_Biking_g01_c02.avi, ...\n","Billiards                150           v_Billiards_g01_c01.avi, v_Billiards_g01_c02.avi, ...\n","BlowDryHair              131           v_BlowDryHair_g01_c01.avi, v_BlowDryHair_g01_c02.avi, ...\n","BlowingCandles           109           v_BlowingCandles_g01_c01.avi, v_BlowingCandles_g01_c02.avi, ...\n","BodyWeightSquats         112           v_BodyWeightSquats_g01_c01.avi, v_BodyWeightSquats_g01_c02.avi, ...\n","Bowling                  155           v_Bowling_g01_c01.avi, v_Bowling_g01_c02.avi, ...\n","BoxingPunchingBag        163           v_BoxingPunchingBag_g01_c01.avi, v_BoxingPunchingBag_g01_c02.avi, ...\n","BoxingSpeedBag           134           v_BoxingSpeedBag_g01_c01.avi, v_BoxingSpeedBag_g01_c02.avi, ...\n","BreastStroke             101           v_BreastStroke_g01_c01.avi, v_BreastStroke_g01_c02.avi, ...\n","BrushingTeeth            131           v_BrushingTeeth_g01_c01.avi, v_BrushingTeeth_g01_c02.avi, ...\n","CleanAndJerk             112           v_CleanAndJerk_g01_c01.avi, v_CleanAndJerk_g01_c02.avi, ...\n","CliffDiving              138           v_CliffDiving_g01_c01.avi, v_CliffDiving_g01_c02.avi, ...\n","CricketBowling           139           v_CricketBowling_g01_c01.avi, v_CricketBowling_g01_c02.avi, ...\n","CricketShot              167           v_CricketShot_g01_c01.avi, v_CricketShot_g01_c02.avi, ...\n","CuttingInKitchen         110           v_CuttingInKitchen_g01_c01.avi, v_CuttingInKitchen_g01_c02.avi, ...\n","Diving                   150           v_Diving_g01_c01.avi, v_Diving_g01_c02.avi, ...\n","Drumming                 161           v_Drumming_g01_c01.avi, v_Drumming_g01_c02.avi, ...\n","Fencing                  111           v_Fencing_g01_c01.avi, v_Fencing_g01_c02.avi, ...\n","FieldHockeyPenalty       126           v_FieldHockeyPenalty_g01_c01.avi, v_FieldHockeyPenalty_g01_c02.avi, ...\n","FloorGymnastics          125           v_FloorGymnastics_g01_c01.avi, v_FloorGymnastics_g01_c02.avi, ...\n","FrisbeeCatch             126           v_FrisbeeCatch_g01_c01.avi, v_FrisbeeCatch_g01_c02.avi, ...\n","FrontCrawl               137           v_FrontCrawl_g01_c01.avi, v_FrontCrawl_g01_c02.avi, ...\n","GolfSwing                139           v_GolfSwing_g01_c01.avi, v_GolfSwing_g01_c02.avi, ...\n","Haircut                  130           v_Haircut_g01_c01.avi, v_Haircut_g01_c02.avi, ...\n","HammerThrow              150           v_HammerThrow_g01_c01.avi, v_HammerThrow_g01_c02.avi, ...\n","Hammering                140           v_Hammering_g01_c01.avi, v_Hammering_g01_c02.avi, ...\n","HandstandPushups         128           v_HandstandPushups_g01_c01.avi, v_HandstandPushups_g01_c02.avi, ...\n","HandstandWalking         111           v_HandstandWalking_g01_c01.avi, v_HandstandWalking_g01_c02.avi, ...\n","HeadMassage              147           v_HeadMassage_g01_c01.avi, v_HeadMassage_g01_c02.avi, ...\n","HighJump                 123           v_HighJump_g01_c01.avi, v_HighJump_g01_c02.avi, ...\n","HorseRace                124           v_HorseRace_g01_c01.avi, v_HorseRace_g01_c02.avi, ...\n","HorseRiding              164           v_HorseRiding_g01_c01.avi, v_HorseRiding_g01_c02.avi, ...\n","HulaHoop                 125           v_HulaHoop_g01_c01.avi, v_HulaHoop_g01_c02.avi, ...\n","IceDancing               158           v_IceDancing_g01_c01.avi, v_IceDancing_g01_c02.avi, ...\n","JavelinThrow             117           v_JavelinThrow_g01_c01.avi, v_JavelinThrow_g01_c02.avi, ...\n","JugglingBalls            121           v_JugglingBalls_g01_c01.avi, v_JugglingBalls_g01_c02.avi, ...\n","JumpRope                 144           v_JumpRope_g01_c01.avi, v_JumpRope_g01_c02.avi, ...\n","JumpingJack              123           v_JumpingJack_g01_c01.avi, v_JumpingJack_g01_c02.avi, ...\n","Kayaking                 141           v_Kayaking_g01_c01.avi, v_Kayaking_g01_c02.avi, ...\n","Knitting                 123           v_Knitting_g01_c01.avi, v_Knitting_g01_c02.avi, ...\n","LongJump                 131           v_LongJump_g01_c01.avi, v_LongJump_g01_c02.avi, ...\n","Lunges                   127           v_Lunges_g01_c01.avi, v_Lunges_g01_c02.avi, ...\n","MilitaryParade           125           v_MilitaryParade_g01_c01.avi, v_MilitaryParade_g01_c02.avi, ...\n","Mixing                   136           v_Mixing_g01_c01.avi, v_Mixing_g01_c02.avi, ...\n","MoppingFloor             110           v_MoppingFloor_g01_c01.avi, v_MoppingFloor_g01_c02.avi, ...\n","Nunchucks                132           v_Nunchucks_g01_c01.avi, v_Nunchucks_g01_c02.avi, ...\n","ParallelBars             114           v_ParallelBars_g01_c01.avi, v_ParallelBars_g01_c02.avi, ...\n","PizzaTossing             113           v_PizzaTossing_g01_c01.avi, v_PizzaTossing_g01_c02.avi, ...\n","PlayingCello             164           v_PlayingCello_g01_c01.avi, v_PlayingCello_g01_c02.avi, ...\n","PlayingDaf               151           v_PlayingDaf_g01_c01.avi, v_PlayingDaf_g01_c02.avi, ...\n","PlayingDhol              164           v_PlayingDhol_g01_c01.avi, v_PlayingDhol_g01_c02.avi, ...\n","PlayingFlute             155           v_PlayingFlute_g01_c01.avi, v_PlayingFlute_g01_c02.avi, ...\n","PlayingGuitar            160           v_PlayingGuitar_g01_c01.avi, v_PlayingGuitar_g01_c02.avi, ...\n","PlayingPiano             105           v_PlayingPiano_g01_c01.avi, v_PlayingPiano_g01_c02.avi, ...\n","PlayingSitar             157           v_PlayingSitar_g01_c01.avi, v_PlayingSitar_g01_c02.avi, ...\n","PlayingTabla             111           v_PlayingTabla_g01_c01.avi, v_PlayingTabla_g01_c02.avi, ...\n","PlayingViolin            100           v_PlayingViolin_g01_c01.avi, v_PlayingViolin_g01_c02.avi, ...\n","PoleVault                149           v_PoleVault_g01_c01.avi, v_PoleVault_g01_c02.avi, ...\n","PommelHorse              123           v_PommelHorse_g01_c01.avi, v_PommelHorse_g01_c02.avi, ...\n","PullUps                  100           v_PullUps_g01_c01.avi, v_PullUps_g01_c02.avi, ...\n","Punch                    160           v_Punch_g01_c01.avi, v_Punch_g01_c02.avi, ...\n","PushUps                  102           v_PushUps_g01_c01.avi, v_PushUps_g01_c02.avi, ...\n","Rafting                  111           v_Rafting_g01_c01.avi, v_Rafting_g01_c02.avi, ...\n","RockClimbingIndoor       144           v_RockClimbingIndoor_g01_c01.avi, v_RockClimbingIndoor_g01_c02.avi, ...\n","RopeClimbing             119           v_RopeClimbing_g01_c01.avi, v_RopeClimbing_g01_c02.avi, ...\n","Rowing                   137           v_Rowing_g01_c01.avi, v_Rowing_g01_c02.avi, ...\n","SalsaSpin                133           v_SalsaSpin_g01_c01.avi, v_SalsaSpin_g01_c02.avi, ...\n","ShavingBeard             161           v_ShavingBeard_g01_c01.avi, v_ShavingBeard_g01_c02.avi, ...\n","Shotput                  144           v_Shotput_g01_c01.avi, v_Shotput_g01_c02.avi, ...\n","SkateBoarding            120           v_SkateBoarding_g01_c01.avi, v_SkateBoarding_g01_c02.avi, ...\n","Skiing                   135           v_Skiing_g01_c01.avi, v_Skiing_g01_c02.avi, ...\n","Skijet                   100           v_Skijet_g01_c01.avi, v_Skijet_g01_c02.avi, ...\n","SkyDiving                110           v_SkyDiving_g01_c01.avi, v_SkyDiving_g01_c02.avi, ...\n","SoccerJuggling           147           v_SoccerJuggling_g01_c01.avi, v_SoccerJuggling_g01_c02.avi, ...\n","SoccerPenalty            137           v_SoccerPenalty_g01_c01.avi, v_SoccerPenalty_g01_c02.avi, ...\n","StillRings               112           v_StillRings_g01_c01.avi, v_StillRings_g01_c02.avi, ...\n","SumoWrestling            116           v_SumoWrestling_g01_c01.avi, v_SumoWrestling_g01_c02.avi, ...\n","Surfing                  126           v_Surfing_g01_c01.avi, v_Surfing_g01_c02.avi, ...\n","Swing                    131           v_Swing_g01_c01.avi, v_Swing_g01_c02.avi, ...\n","TableTennisShot          140           v_TableTennisShot_g01_c01.avi, v_TableTennisShot_g01_c02.avi, ...\n","TaiChi                   100           v_TaiChi_g01_c01.avi, v_TaiChi_g01_c02.avi, ...\n","TennisSwing              166           v_TennisSwing_g01_c01.avi, v_TennisSwing_g01_c02.avi, ...\n","ThrowDiscus              130           v_ThrowDiscus_g01_c01.avi, v_ThrowDiscus_g01_c02.avi, ...\n","TrampolineJumping        119           v_TrampolineJumping_g01_c01.avi, v_TrampolineJumping_g01_c02.avi, ...\n","Typing                   136           v_Typing_g01_c01.avi, v_Typing_g01_c02.avi, ...\n","UnevenBars               104           v_UnevenBars_g01_c01.avi, v_UnevenBars_g01_c02.avi, ...\n","VolleyballSpiking        116           v_VolleyballSpiking_g01_c01.avi, v_VolleyballSpiking_g01_c02.avi, ...\n","WalkingWithDog           123           v_WalkingWithDog_g01_c01.avi, v_WalkingWithDog_g01_c02.avi, ...\n","WallPushups              130           v_WallPushups_g01_c01.avi, v_WallPushups_g01_c02.avi, ...\n","WritingOnBoard           152           v_WritingOnBoard_g01_c01.avi, v_WritingOnBoard_g01_c02.avi, ...\n","YoYo                     128           v_YoYo_g01_c01.avi, v_YoYo_g01_c02.avi, ...\n"]}],"source":["ucf_videos = list_ucf_videos()\n","categories = {}\n","for video in ucf_videos:\n","  category = video[2:-12]\n","  if category not in categories:\n","    categories[category] = []\n","  categories[category].append(video)\n","print(\"Found in total %d videos in overall %d categories.\" % (len(ucf_videos), len(categories)))\n","\n","print(\"\\n\")\n","head1 = \"CATEGORY\"\n","head2 = \"No. of Videos\"\n","head3 = \"Details\"\n","print(\" \",head1,\" \\t  \",head2,\" \\t\\t\\t \",head3)\n","for category, sequences in categories.items():\n","  summary = \", \".join(sequences[:2])\n","  print(\"%-20s    %4d           %s, ...\" % (category, len(sequences), summary))"]},{"cell_type":"markdown","metadata":{"id":"YMbN4HqKvN0W"},"source":["# Step 5: Fetch a random video"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1998,"status":"ok","timestamp":1705421234171,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"},"user_tz":-330},"id":"BEdjsXVauFYq","outputId":"7674b93e-e14f-4460-a759-75c495fb3c91"},"outputs":[{"output_type":"stream","name":"stdout","text":["Fetching https://www.crcv.ucf.edu/THUMOS14/UCF101/UCF101/v_LongJump_g01_c01.avi => /tmp/tmpdcet_ok6/v_LongJump_g01_c01.avi\n"]},{"output_type":"execute_result","data":{"text/plain":["(143, 224, 224, 3)"]},"metadata":{},"execution_count":9}],"source":["video_path = fetch_ucf_video(\"v_LongJump_g01_c01.avi\")\n","sample_video = load_video(video_path)\n","sample_video1 = load_video(video_path)[:100]\n","sample_video.shape"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":245,"output_embedded_package_id":"1j7PhgpPyedBPvmg9JE6tye0qQ_Yv70gP"},"executionInfo":{"elapsed":8090,"status":"ok","timestamp":1705421248614,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"},"user_tz":-330},"id":"HpaZBma5vik0","outputId":"55461178-24ad-494d-8804-75e4cd8fd8ec"},"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}],"source":["to_gif(sample_video1)"]},{"cell_type":"markdown","metadata":{"id":"tBIFmZivv2k-"},"source":["# Step 6: Predict from the video"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"S9WicsikvtJe","executionInfo":{"status":"ok","timestamp":1705421261143,"user_tz":-330,"elapsed":4598,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"}}},"outputs":[],"source":["i3d = hub.load(\"https://tfhub.dev/deepmind/i3d-kinetics-400/1\").signatures['default']"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"oPT7tCcjvxQf","executionInfo":{"status":"ok","timestamp":1705421264569,"user_tz":-330,"elapsed":3,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"}}},"outputs":[],"source":["def predict(sample_video):\n","  # Add a batch axis to the to the sample video.\n","  model_input = tf.constant(sample_video, dtype=tf.float32)[tf.newaxis, ...]\n","\n","  logits = i3d(model_input)['default'][0]\n","  probabilities = tf.nn.softmax(logits)\n","\n","  print(\"Top 5 actions:\")\n","  for i in np.argsort(probabilities)[::-1][:5]:\n","    print(f\"  {labels[i]:22}: {probabilities[i] * 100:5.2f}%\")"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8455,"status":"ok","timestamp":1705421277663,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"},"user_tz":-330},"id":"jw6V78C5v-LP","outputId":"2b0f9d96-9220-42f7-bcaf-f95138efa6cc"},"outputs":[{"output_type":"stream","name":"stdout","text":["Top 5 actions:\n","  long jump             : 62.05%\n","  triple jump           : 37.88%\n","  hurdling              :  0.06%\n","  pole vault            :  0.01%\n","  high jump             :  0.00%\n"]}],"source":["predict(sample_video)"]},{"cell_type":"markdown","metadata":{"id":"_fdJBVOmwuh3"},"source":["# Check for some sample Videos"]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1472,"status":"ok","timestamp":1705421285912,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"},"user_tz":-330},"id":"u0qdY_3qwAaK","outputId":"302a2802-8325-416e-893b-8ea5a84a5ca0"},"outputs":[{"output_type":"stream","name":"stdout","text":["Fetching https://www.crcv.ucf.edu/THUMOS14/UCF101/UCF101/v_WritingOnBoard_g01_c01.avi => /tmp/tmpdcet_ok6/v_WritingOnBoard_g01_c01.avi\n"]},{"output_type":"execute_result","data":{"text/plain":["(153, 224, 224, 3)"]},"metadata":{},"execution_count":14}],"source":["video_path = fetch_ucf_video(\"v_WritingOnBoard_g01_c01.avi\")\n","sample_video = load_video(video_path)\n","sample_video1 = load_video(video_path)[:100]\n","sample_video.shape"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":245,"output_embedded_package_id":"15-O9tfd5LKVv8oWyZjvNbUyGSRPA8hFs"},"executionInfo":{"elapsed":5761,"status":"ok","timestamp":1705421295478,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"},"user_tz":-330},"id":"xx4nzdA8w0bF","outputId":"71ac5aef-b8a3-4af4-bbd7-8cbdb546bd21"},"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}],"source":["to_gif(sample_video1)"]},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5747,"status":"ok","timestamp":1705421320308,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"},"user_tz":-330},"id":"FASvqaZQw2eH","outputId":"214553fe-705f-4dec-a066-f4cf8cf499ce"},"outputs":[{"output_type":"stream","name":"stdout","text":["Top 5 actions:\n","  writing               : 99.85%\n","  spray painting        :  0.01%\n","  beatboxing            :  0.01%\n","  ice fishing           :  0.01%\n","  smoking               :  0.01%\n"]}],"source":["predict(sample_video)"]},{"cell_type":"code","execution_count":17,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"eWaRzFQVxxPk","outputId":"cc3bb75f-1ed2-4a8f-d950-3d52959ae7e2","executionInfo":{"status":"ok","timestamp":1705421327070,"user_tz":-330,"elapsed":1744,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Fetching https://www.crcv.ucf.edu/THUMOS14/UCF101/UCF101/v_PlayingGuitar_g01_c02.avi => /tmp/tmpdcet_ok6/v_PlayingGuitar_g01_c02.avi\n"]},{"output_type":"execute_result","data":{"text/plain":["(250, 224, 224, 3)"]},"metadata":{},"execution_count":17}],"source":["video_path = fetch_ucf_video(\"v_PlayingGuitar_g01_c02.avi\")\n","sample_video = load_video(video_path)\n","sample_video1 = load_video(video_path)[:100]\n","sample_video.shape"]},{"cell_type":"code","execution_count":18,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":245,"output_embedded_package_id":"1vTKQTQ6uEc6vz_KNq5Bxvq08y4gLDB1u"},"id":"94zRn7w0yEV0","outputId":"ac3c1075-59ec-4ba6-a8ba-98c163da3c31","executionInfo":{"status":"ok","timestamp":1705421343027,"user_tz":-330,"elapsed":10070,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"}}},"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}],"source":["to_gif(sample_video1)"]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"x9OGh2F9yH6P","outputId":"6b646b05-ea34-4af9-8631-c4dc999132a1","executionInfo":{"status":"ok","timestamp":1705421355513,"user_tz":-330,"elapsed":7069,"user":{"displayName":"Manish Kumar","userId":"09906261690548294940"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Top 5 actions:\n","  playing guitar        : 89.51%\n","  strumming guitar      :  9.17%\n","  busking               :  0.35%\n","  playing drums         :  0.28%\n","  recording music       :  0.23%\n"]}],"source":["predict(sample_video)"]}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":["f5ju43bztD-N","F4CqIAvgtuG9","4J1dNlo9t7Yo","YMbN4HqKvN0W","tBIFmZivv2k-","_fdJBVOmwuh3"],"provenance":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.8"}},"nbformat":4,"nbformat_minor":0}